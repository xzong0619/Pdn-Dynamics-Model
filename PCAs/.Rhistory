lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[1] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = "blue")
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[1] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = "blue")
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[1] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2)
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[1] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2)
## PC1
iPC <- 1
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 4, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=1, type="Gram", sparse="penalty", trace=TRUE, para = lambda1[i])
pc1_pev[i] <- pc1$pev
}
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2)
## PC1
iPC <- 1
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 4, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=1, type="Gram", sparse="penalty", trace=TRUE, para = lambda1[i])
pc1_pev[i] <- pc1$pev
}
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
## PC2
iPC <- 2
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 3, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=2, type="Gram", sparse="penalty", trace=TRUE, para = c(0, lambda1[i]))
pc1_pev[i] <- pc1$pev
}
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
iPC <- 2
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 3, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=2, type="Gram", sparse="penalty", trace=TRUE, para = c(0, lambda1[i]))
pc1_pev[i] <- pc1$pev
}
iPC <- 2
PCn <- paste("PC",iPC)
pc1_pev <- c()
lambda1 <- seq(0, 3, by = 0.1)
lambda1
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=2, type="Gram", sparse="penalty", trace=TRUE, para = c(0, lambda1[i]))
pc1_pev[i] <- pc1$pev
}
warnings()
pc1$pev
## PC2
iPC <- 2
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 3, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=2, type="Gram", sparse="penalty", trace=TRUE, para = c(0, lambda1[i]))
pc1_pev[i] <- pc1$pev[iPC]
}
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
## PC2
iPC <- 2
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 3, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=2, type="Gram", sparse="penalty", trace=TRUE, para = c(0.06, lambda1[i]))
pc1_pev[i] <- pc1$pev[iPC]
}
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
## PC3
iPC <- 3
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 2, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=2, type="Gram", sparse="penalty", trace=TRUE, para = c(0, 0, lambda1[i]))
pc1_pev[i] <- pc1$pev[iPC]
}
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
## PC3
iPC <- 3
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 2, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = c(0, 0, lambda1[i]))
pc1_pev[i] <- pc1$pev[iPC]
}
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
## PC3
iPC <- 3
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 2, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = c(0.06, 0.16, lambda1[i]))
pc1_pev[i] <- pc1$pev[iPC]
}
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
c(1,2)
c(c(1,2),3)
## PC3
iPC <- 3
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 2, by = 0.05)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = c(0.06, 0.16, lambda1[i]))
pc1_pev[i] <- pc1$pev[iPC]
}
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
## PC3
iPC <- 3
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 2, by = 0.05)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = c(0,0, lambda1[i]))
pc1_pev[i] <- pc1$pev[iPC]
}
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
## PC4
iPC <- 4
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 2, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = c(0.06, 0.16, 0.1, lambda1[i]))
pc1_pev[i] <- pc1$pev[iPC]
}
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
## PC4
iPC <- 4
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 2, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = c(0, 0, 0, lambda1[i]))
pc1_pev[i] <- pc1$pev[iPC]
}
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
c(1,2)[1:1]
c(1,2)[1:0]
lambda1_paper[1:i-1]
lambda1_paper[1:iPC-1]
## PC4
iPC <- 4
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 2, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = c(lambda1_paper[1:iPC-1], lambda1[i]))
pc1_pev[i] <- pc1$pev[iPC]
}
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
png("test.png",width=3.25,height=3.25,units="in",res=1200)
## PC4
iPC <- 4
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 2, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = c(lambda1_paper[1:iPC-1], lambda1[i]))
pc1_pev[i] <- pc1$pev[iPC]
}
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
png("test.png",width=3.25,height=3.25,units="in",res=1200)
setwd("~/GitHub/Pdn-Dynamics-Model/PCAs")
## PC4
iPC <- 4
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 2, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = c(lambda1_paper[1:iPC-1], lambda1[i]))
pc1_pev[i] <- pc1$pev[iPC]
}
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
png("test.png",width=3.25,height=3.25,units="in",res=1200)
png("test.png",width=3.25,height=3.25,units="in",res=1200)
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
dev.off()
png("test.png",width=5,height=5,units="in",res=900)
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
dev.off()
plot_PCi <- function(iPC, lambda_range) {
PCn <- paste("PC",iPC)
pc_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, lambda_range, by = 0.1)
for (i in 1:length(lambda1)){
pc <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = c(lambda1_paper[1:iPC-1], lambda1[i]))
pc_pev[i] <- pc1$pev[iPC]
}
png("test.png",width=5,height=5,units="in",res=900)
plot(lambda1, pc_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc_pev, type ='l', lty=2, col = 'blue')
dev.off()
}
plot_PCi(2,2.5)
plot_PCi(3,2)
plot_PCi <- function(iPC, lambda_range) {
PCn <- paste("PC",iPC)
pc_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, lambda_range, by = 0.1)
for (i in 1:length(lambda1)){
pc <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = c(lambda1_paper[1:iPC-1], lambda1[i]))
pc_pev[i] <- pc$pev[iPC]
}
png("test.png",width=5,height=5,units="in",res=900)
plot(lambda1, pc_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc_pev, type ='l', lty=2, col = 'blue')
dev.off()
}
plot_PCi(2,2.5)
plot_PCi <- function(iPC, lambda_range) {
PCn <- paste("PC",iPC)
pc_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, lambda_range, by = 0.1)
for (i in 1:length(lambda1)){
pc <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = c(lambda1_paper[1:iPC-1], lambda1[i]))
pc_pev[i] <- pc$pev[iPC]
}
png(paste(PCn, ".png") ,width=5,height=5,units="in",res=900)
plot(lambda1, pc_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc_pev, type ='l', lty=2, col = 'blue')
dev.off()
}
plot_PCi(2,2.5)
plot_PCi <- function(iPC, lambda_range) {
PCn <- paste("PC",iPC)
pc_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, lambda_range, by = 0.1)
for (i in 1:length(lambda1)){
pc <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = c(lambda1_paper[1:iPC-1], lambda1[i]))
pc_pev[i] <- pc$pev[iPC]
}
png(paste(PCn, ".png", sep = '_') ,width=5,height=5,units="in",res=900)
plot(lambda1, pc_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc_pev, type ='l', lty=2, col = 'blue')
dev.off()
}
plot_PCi(2,2.5)
plot_PCi <- function(iPC, lambda_range) {
PCn <- paste("PC",iPC, sep = '')
pc_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, lambda_range, by = 0.1)
for (i in 1:length(lambda1)){
pc <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = c(lambda1_paper[1:iPC-1], lambda1[i]))
pc_pev[i] <- pc$pev[iPC]
}
png(paste(PCn, ".png", sep = '') ,width=5,height=5,units="in",res=900)
plot(lambda1, pc_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc_pev, type ='l', lty=2, col = 'blue')
dev.off()
}
plot_PCi(2,2.5)
## PC2
iPC <- 2
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 3, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = c(lambda1_paper[1:iPC-1], lambda1[i]))
pc1_pev[i] <- pc1$pev[iPC]
}
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
plot_PCi(2,3)
## PC1
iPC <- 1
## Use to plot figure 2 in Zou SPCA paper
## library and data
library(elasticnet)
data(pitprops)
# Lambda1 used in the paper
lambda1_paper <- c(0.06, 0.16, 0.1, 0.5, 0.5, 0.5)
## PC1
iPC <- 1
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 4, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = lambda1[i])
pc1_pev[i] <- pc1$pev[iPC]
}
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
## Plot PC function,
## takes in the index of PC and the range of lambda1 used in plotting
plot_PCi <- function(iPC, lambda_range) {
PCn <- paste("PC",iPC, sep = '')
pc_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, lambda_range, by = 0.1)
for (i in 1:length(lambda1)){
pc <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = c(lambda1_paper[1:iPC-1], lambda1[i]))
pc_pev[i] <- pc$pev[iPC]
}
png(paste(PCn, ".png", sep = '') ,width=5,height=5,units="in",res=900)
plot(lambda1, pc_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc_pev, type ='l', lty=2, col = 'blue')
dev.off()
}
# PC 2
plot_PCi(2,3)
# PC 3
plot_PCi(3,2)
# PC 4
plot_PCi(4,2)
# PC 5
plot_PCi(5,1.5)
# PC 6
plot_PCi(6,1.5)
## PC1
iPC <- 1
PCn <- paste("PC",iPC)
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 4, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = lambda1[i])
pc1_pev[i] <- pc1$pev[iPC]
}
png(paste(PCn, ".png", sep = '') ,width=5,height=5,units="in",res=900)
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
dev.off()
## PC1
iPC <- 1
PCn <- paste("PC",iPC, sep = '')
pc1_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, 4, by = 0.1)
for (i in 1:length(lambda1)){
pc1 <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE, para = lambda1[i])
pc1_pev[i] <- pc1$pev[iPC]
}
png(paste(PCn, ".png", sep = '') ,width=5,height=5,units="in",res=900)
plot(lambda1, pc1_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc1_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc1_pev, type ='l', lty=2, col = 'blue')
dev.off()
# PC 5
plot_PCi(5,1.1)
# PC 6
plot_PCi(6,1.1)
plot_PCi <- function(iPC, lambda_range) {
PCn <- paste("PC",iPC, sep = '')
pc_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, lambda_range, by = 0.1)
for (i in 1:length(lambda1)){
pc <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE,
para = c(rep(0,times = iPC-1), lambda1[i]))#para = c(lambda1_paper[1:iPC-1], lambda1[i]))
pc_pev[i] <- pc$pev[iPC]
}
png(paste(PCn, ".png", sep = '') ,width=5,height=5,units="in",res=900)
plot(lambda1, pc_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc_pev, type ='l', lty=2, col = 'blue')
dev.off()
}
# PC 5
plot_PCi(5,1.1)
# PC 6
plot_PCi(6,1.1)
## Plot PC function,
## takes in the index of PC and the range of lambda1 used in plotting
plot_PCi <- function(iPC, lambda_range) {
PCn <- paste("PC",iPC, sep = '')
pc_pev <- c()
# lambda1 used to plot
lambda1 <- seq(0, lambda_range, length = 20)
for (i in 1:length(lambda1)){
pc <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE,
para = c(rep(0,times = iPC-1), lambda1[i]))#para = c(lambda1_paper[1:iPC-1], lambda1[i]))
pc_pev[i] <- pc$pev[iPC]
}
png(paste(PCn, ".png", sep = '') ,width=5,height=5,units="in",res=900)
plot(lambda1, pc_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc_pev, type ='l', lty=2, col = 'blue')
dev.off()
}
# PC 5
plot_PCi(5,1.1)
# PC 6
plot_PCi(6,1.1)
## Use to plot figure 2 in Zou SPCA paper
## library and data
library(elasticnet)
data(pitprops)
# Lambda1 used in the paper
lambda1_paper <- c(0.06, 0.16, 0.1, 0.5, 0.5, 0.5)
## Plot PC function,
## takes in the index of PC and the range of lambda1 used in plotting
plot_PCi <- function(iPC, lambda_range) {
PCn <- paste("PC",iPC, sep = '')
pc_pev <- c()
# lambda1 used to plot for this PC
lambda1 <- seq(0, lambda_range, length = 20)
# Set the lambdas for previous PCs
if (iPC >= 1){
# previous lambdas, Set all other PC pently as 0, no lasso regularization
pre_lambdas = rep(0,times = iPC-1)
# previous lambdas, Set all other PC pently as the previously determined values
pre_lambdas = lambda1_paper[1:iPC-1]
} else {
pre_lambdas = c()
}
# Loop through each lambda for plotting
for (i in 1:length(lambda1)){
pc <- spca(pitprops, K=iPC, type="Gram", sparse="penalty", trace=TRUE,
para = c(pre_lambdas, lambda1[i]))
pc_pev[i] <- pc$pev[iPC]
}
# save the plot to png
png(paste(PCn, ".png", sep = '') ,width=5,height=5,units="in",res=900)
plot(lambda1, pc_pev, main = PCn, ylab = 'PEV',  col = "red")
lines(lambda1, pc_pev, type ='l', lty=2)
lines(lambda1_paper[iPC] * rep(1, times = length((lambda1))), pc_pev, type ='l', lty=2, col = 'blue')
dev.off()
}
# PC 1
plot_PCi(1,3.5)
# PC 2
plot_PCi(2,3)
# PC 3
plot_PCi(3,2)
# PC 4
plot_PCi(4,2)
# PC 5
plot_PCi(5,1.1)
# PC 6
plot_PCi(6,1.1)
